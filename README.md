# Исследование мультимодального обнаружения объектов в условиях сильных перекрытий

## Участники
- Куранова Полина - ИСУ 466426
- Сегень Радмила (https://github.com/Radmilase) - ИСУ
- * Вероника (https://github.com/VerDddD) - ИСУ
- Талканов Амир (https://github.com/BegomAmir) - ИСУ

## Описание исследования
В ходе выполнения курсовой работы по дисциплине "Методы машинного обучения в робототехнике" было выполнено исследование по теме мультимодального обнаружения объектов в условиях сильных перекрытий.

### Цель исследования
Провести сравнительный анализ 4 моделей для мультимодального обнаружения объектов в условиях сильных перекрытий.

Задача мультимодальной детекции объектов подразумевает под собой детекцию объектов на основе информации имеющей разную природу. В нашем случе используется rgb изображение и карта глубины с камеры, а так же в 2 случаях оцененная карта глубины полученная с помощью внешней модели MiDaS (https://github.com/isl-org/MiDaS).

### Гипотеза
*TODO*
------ рассказать какая модель лучше и почему

### Задачи исследования
- Снять датасет (определить детектируемые объекты, объем датасета и снимаемые сцены).
- Разметить датасет (использовалась платформа Label Studio).
- Реализовать модели.
- Обучить модели, рассчитать метрики качества обучения модели.
- Реализовать приложение для тестирования работы в режиме реального времени.
- Протестировать приложение для каждой модели, рассчитать среднее время обработки кадра для каждой модели.

### Описание репозитория

В данном репозитории представлен исходный код используемый для проведения исследования.

В папке notebooks представлены скрипты ипользуемые для обучения моделей, а в папке src представлен исходный код необходимый для работы приложения. Главный файл приложения main_test.py.

### Описание датасета
*TODO*
------ размер, количество объектов и прочее

### Описание моделей

#### Модель 1: Базовая модель (rgbd_base_model)
*TODO*
------ ссылка на baseline + схема

#### Модель 2: 4 канальная модель с механизмом внимания (rgbd_attention_model)
*TODO*
------ чем отличается от предыдущей + схема

#### Модель 3: 5 канальная модель с механизмом внимания (rgbdd_attention_model)
*TODO*
------ чем отличается от предыдущей + схема

#### Модель 4: 5 канальная модель с механизмом гейтирования (rgbdd_gating_model)
*TODO*
------ чем отличается от предыдущей + схема

В процессе экспериментов обучение моделей производилось на 30 эпохах.

### Описание используемых метрик
*TODO*

### Описание приложения
*TODO*

## Демонстрация работы

*TODO*

ссылка на видео

gif анимация

## Устанока и развертывание

Обучение моделей производилось с использованием вычислительных мощностей сред Google Colab и Kaggle. Используемые скрипты представлены в папке notebooks.

Приложение для тестирования работы моделей на данных с видеокамеры RealSense разрабатывалось с использованием окружения Anaconda. Файл с используемым окружением: environment.yaml.

Для развертки окружения выполните следующие команды:
- Убедитесь, что у вас установлен Anaconda или Miniconda.
- Создайте окружение на основе файла environment.yml: 
```bash
conda env create -f environment.yml
```
- Активируйте окружение:
```bash
conda activate anaconda_env  # или имя, указанное в поле name в environment.yml
```
- Если зависимости обновлялись, синхронизируйте окружение:
```bash
conda env update --file environment.yml --prune
```

## Запуск и использование

### Обучение моделей
Для повторения процесса обучения моделей необходимо запустить скрипты представленые в папке notebooks. Их можно скачать из репозитория и вреучную выгрузить в Google Colab или Kaggle. Рекомендуется использовать GPU для более быстрого обучения.

Так же скрипты можно запустить локально, но для этого требуются минимум 7.28 Гб свободной памяти для датасета и достаточные вычислительные мощности.

### Конфигурация приложения
Для конфигурации работы приложения необходимо заполнить файл config/config.py.
Необходимо указать значение следующим переменным:
- CLASSES_PATH - путь к файлу с описанием классов,
- MODEL - название используемой модели,
- MODEL_PATH - путь к весам обученной модели,
- DEPTH_MIN, DEPTH_MAX, IMG_SIZE - параметры обучения.

### Запуск приложения для тестирования работы моделей на данных с видеокамеры RealSense
- загрузка репозитория:
```bash
git@github.com:KuranovaPolina/multimodal_object_detection.git
```
- Активация окружения: 
```bash
conda activate anaconda_env
```
- Запуск: 
```bash
python main_test.py
```

## Описание полученных результатов

*TODO*

------- Сравнение метрик в таблице

